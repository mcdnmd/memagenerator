<!DOCTYPE html>
<html>
  <%- include('./partials/head'); %>
  <body>
    <div class="site_header">
      <h1>MemaGen.com</h1>
    </div>
    <div class="page">

      <div class="media_content" id="media">
        <canvas id="media-source"></canvas>
      </div>

      <div class="options">
        <div class="media_uploader option">
          <input id="file" type="file" accept="image/*">
        </div>

        <div class="upper-text option">
          <input id="upper-text" type="text" placeholder="Upper text">
        </div>

        <div class="lower-text option">
          <input type="text" placeholder="Lower text">
        </div>

        <div class="submit option">
          <input type="submit">
        </div>
      </div>
    </div>

  </body>

  <script>
    let file = document.getElementById('file');
    file.addEventListener("change", (e) => {
      let canvas = document.getElementById('media-source');
      let ctx = canvas.getContext('2d');
      let reader  = new FileReader();
      let image = new Image();

      reader.addEventListener('load',  (e) => {
        image.src = reader.result;
      }, false);

      reader.readAsDataURL(file.files[0]);

      image.onload = () =>{
        canvas.setAttribute('width', image.width);
        canvas.setAttribute('height', image.height);
        console.log(image.width, image.height)
        console.log(image);
        ctx.drawImage(image, 0, 0);
      };
    }, false);

    let upperText = document.getElementById('upper-text');
    upperText.addEventListener('change', (e) => {
      let canvas = document.getElementById('media-source');
      let ctx = canvas.getContext('2d');
      ctx.font = "72px Impact";
      ctx.fillText(upperText.value, canvas.clientWidth / 2, 150);
    }, false);

  </script>

</html>
